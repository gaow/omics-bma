#!/usr/bin/env sos-runner
#fileformat=SOSNB1.0

#%% code 1
%use python
from OmicsBMA.deepdishio import load
import pandas as pd
pd.set_option('display.max_columns', None)
pd.set_option('display.max_rows', None)

def pd_concat2(data):
    return pd.concat({k: pd.concat(v) for k, v in data.items() if v})

sstats = pd_concat2(load('output/sumstats_20160602_master.h5'))
posterior = load('output/posterior_20160602_master.h5')
res = load('output/test_association_20160602_master.h5')
perm_pvals = res['JoinPermPvals']
jsstats = pd_concat2(res['JoinSstats'])
l10bfs = pd.concat(res['log10BFs'])

#%% code 2
posterior

#%% code 3
sstats

#%% code 4
jsstats

#%% code 5
l10bfs

#%% code 6
perm_pvals